{% extends "parent.html" %}
{% block head %}
{% endblock %}
{% block page_name %}Rock Willow Transactions{% endblock %}

{% block body %}
<div class="content-section">
    <h2>Pending transactions</h2>
    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col">Date</th>
                <th scope="col">Merchant</th>
                <th scope="col">Category</th>
                <th scope="col">Amount</th>
                <th scope="col">Account</th>
                <th scope="col">Type</th>
                <th scope="col">Note</th>
            </tr>
        </thead>
        <tbody>
            {# BUG: Need to handle no transactions in case of bad filter conditions #}
        {% for transaction in pending_transactions if not transaction == None %}
            <tr>
                <th scope="row">{{transaction.transaction.transaction_date}}</th>
                <td>{{transaction.transaction.merchant_name}}</td>
                <td>{{transaction.category.category_name}}</td>
                <td>{{transaction.transaction.amount}}</td>
                <td>{{transaction.account.account_name}}</td>
                <td>{{transaction.transaction.transaction_type}}</td>
                <td>{{transaction.transaction.note}}</td>
                <td><a class="btn btn-outline-info" href={{url_for("update_transaction", transaction_id=transaction['transaction'].transactionid)}}>Update</a>
            </tr>
        {% endfor %}
        </tbody>
        </table>
    <h2>Posted transactions</h2>
    <table class="table table-hover">
    <thead>
        <tr>
            <th scope="col">Date</th>
            <th scope="col">Merchant</th>
            <th scope="col">Category</th>
            <th scope="col">Amount</th>
            <th scope="col">Account</th>
            <th scope="col">Type</th>
            <th scope="col">Note</th>
        </tr>
    </thead>
    <tbody>
        {# BUG: Need to handle no transactions in case of bad filter conditions #}
    {% for transaction in current_transactions if not transaction == None %}
        <tr>
            <th scope="row">{{transaction.transaction.transaction_date}}</th>
            <td>{{transaction.transaction.merchant_name}}</td>
            <td>{{transaction.category.category_name}}</td>
            <td>{{transaction.transaction.amount}}</td>
            <td>{{transaction.account.account_name}}</td>
            <td>{{transaction.transaction.transaction_type}}</td>
            <td>{{transaction.transaction.note}}</td>
            <td><a class="btn btn-outline-info" href={{url_for("update_transaction", transaction_id=transaction['transaction'].transactionid)}}>Update</a>
        </tr>
    {% endfor %}
    </tbody>
    </table>
</div>
<div class="content-section">
    <form method="POST", action="">
        {{ form.hidden_tag() }}
        {{ form.transactionid()}}
        {# BUG: Need transactionid field to exist #}
        <fieldset class="form-row">
            <div class="col">
                {{form.transaction_date.label(class="form-control-label")}}
                {{form.transaction_date(class="form-control")}}
            </div>
            <div class="col">
                {{form.transaction_type.label(class="form-control-label")}}
                {{form.transaction_type(class="form-control")}}
            </div>
            <div class="col">
                {{form.merchant_name.label(class="form-control-label")}}
                {{form.merchant_name(class="form-control", placeholder="Merchant Name")}}
            </div>
        </fieldset>
        <fieldset class="form-row">
            <div class="col">
                {{form.amount.label(class="form-control-label")}}
                {{form.amount(class="form-control")}}
            </div>
            <div class="col">
                {{form.account.label(class="form-control-label")}}
                {{form.account(class="form-control")}}
            </div>
            <div class="col">
                {{form.category.label(class="form-control-label")}}
                {{form.category(class="form-control")}}
            </div>
            <div class="col">
                {{form.note.label(class="form-control-label")}}
                {{form.note(class="form-control")}}
            </div>
        </fieldset>
        <div class="form-group">
            {{form.submit(class="btn btn-outline-info")}}
        </div>
    </form>
</div>
<div class="content-section">
    <a href="{{url_for("new_account")}}" class="btn btn-outline-info">Add Account</a>
    <a href="{{url_for("new_budget")}}" class="btn btn-outline-info">Add Budget</a>
    <a href="{{url_for("new_category")}}" class="btn btn-outline-info">Add Category</a>
    <a href="{{url_for("new_recurring_transaction")}}" class="btn btn-outline-info">Add Recurring Transaction</a>
</div>
<div class="content-section">
    <h2>Upcoming Features</h2>
    <ul>
        <li>#ToDo: Split Transactions</li>
        <li>#ToDo: Import Transactions</li>
        <li>#ToDo: Set up recurring transactions</li>
        <li>#ToDo: Export Transactions</li>
        <li>#ToDo: Paginate by Month and Year</li>
    </ul>
</div>
{% endblock %}